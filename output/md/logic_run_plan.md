# 📋 기획안: 로직 런 (Logic Run)
> **부제:** AI의 추격을 뿌리치고 논리의 성(Castle)으로 질주하라!
> **작성일:** 2026-02-24
> **작성 목적:** 기존 '스피드 아키텍쳐 빌더' 게임 모드를 대체하는 신규 게임 모드 기획

---

## 1. 📌 개요

### 1.1 게임 컨셉
2~3명의 플레이어가 한 팀이 되어, **실시간으로 의사코드(Pseudo Code)를 작성**해 캐릭터를 전진시키는 **아케이드형 릴레이 코딩 게임**.

### 1.2 핵심 목표
- AI 추격자보다 **먼저 목적지(논리의 성)에 도달**
- 동시에 **코드 완성도(5대 지표)**를 높여 고득점 획득
- 팀원 간의 **협업과 코드 일관성** 강화

### 1.3 기존 모드와의 차이점

| 구분 | 스피드 아키텍쳐 빌더 (구) | 로직 런: AI 추격전 (신) |
|------|---------------------------|------------------------|
| 방식 | 개인/팀 설계 경쟁 | 릴레이 팀 협동 |
| 핵심 긴장감 | 시간 제한 | AI 추격자 |
| 협동 요소 | 낮음 | 높음 (바통 패스, 하이파이브) |
| 학습 요소 | 아키텍쳐 설계 | 의사코드 작성 + 변수 일관성 |

---

## 2. 🎮 게임 메커니즘 (The Gameplay)

### 2.1 릴레이 시스템 (The Baton Pass)

```
[섹터 1] ──────────► [섹터 2] ──────────► [섹터 3] ──── 🏰 Goal
  플레이어 1 담당        플레이어 2 담당        플레이어 3 담당
```

- **구간 분할:** 전체 트랙은 인원수(2~3명)만큼의 **'로직 섹터'**로 나뉨
- **바통 터치:** 현재 주자가 섹터 끝에 도달하면 다음 주자의 화면이 활성화
  - 앞 주자가 작성한 **변수명·로직이 다음 주자에게 실시간 전송**
- **하이파이브 타이밍** 🔥: 교체 시점에 두 플레이어가 동시에 키를 입력하면
  - 성공 → **대시 부스트** 발동 (일시적 이동 속도 2배)
  - 실패 → 일반 속도로 전환

### 2.2 실시간 로직 입력 (Logic Typing)

- 의사코드를 **정확하게 한 줄 입력할 때마다 캐릭터가 전진**
- **일관성 보너스:** 앞사람이 쓴 변수명을 그대로 사용 시 가산점 + 이동속도 유지
- **일관성 위반:** 변수명을 임의로 변경하면 캐릭터가 **멈칫하며 속도 감소**

```
예시)
플레이어 1이 작성: user_list = []      ✅ 올바른 사용 예
플레이어 2가 사용: user_list.append()  ✅ 속도 유지 (+점수)
              or
플레이어 2가 사용: u_list.append()     ❌ 속도 감소 (-점수)
```

### 2.3 AI 추격자 (The AI Shadow) 🤖

- 플레이어 뒤에서 **일정한 속도로 코드를 자동 생성**하며 추격
- AI에게 잡히면 **즉시 게임 오버**
- 팀원이 서로 오타를 지적하거나 다음 로직을 미리 공유하는 **소통 필수**
- AI 속도는 **현재 퀘스트 난이도(CPM 기준)**에 따라 동적으로 조정
- **분노 모드 (Rage Mode):** 팀이 너무 앞서가면 AI가 일시적으로 속도를 급격히 올리는 이벤트 발동 → 긴장감 유지

---

## 3. ⚡ 파니랜드식 방해 요소 및 아이템

### 3.1 방해 요소 (Obstacles)

| 명칭 | 효과 | 관련 지표 |
|------|------|-----------|
| 🌊 **논리 늪 (Logic Swamp)** | 복잡한 조건문 구간. 특정 if-else 구조를 완성해야 탈출 가능 | 예외 처리 |
| 🍌 **오타 바나나 (Syntax Banana)** | 문법 오류 발생 시 캐릭터가 미끄러져 후진 | 구현력 |
| 🔀 **스파게티 존 (Spaghetti Zone)** | 중복 코드 감지 시 발생. 리팩토링 입력으로 탈출 | 추상화 |

### 3.2 아이템 (Power-Ups)

| 명칭 | 획득 조건 | 효과 |
|------|-----------|------|
| 🧪 **추상화 물약 (Abstraction Potion)** | 복잡한 로직을 함수 한 줄로 요약 성공 시 | 대폭 전진 + 추상화 지표 상승 |
| 🛡️ **팀워크 실드 (Teamwork Shield)** | 대기 중인 팀원이 코드 퀴즈 정답 맞히면 | 현재 주자에게 방어막 생성 |
| ⚡ **부스트 캡슐 (Boost Capsule)** | 3줄 연속 오타 없이 완성 시 | 5초간 이동속도 1.5배 |

---

## 4. 🖥️ UI/UX 설계 (Scene Design)

### 4.1 화면 레이아웃

```
┌────────────────── 전체 트랙 진척도 (팀 vs AI 위치) ──────────────────┐
│  🏃‍♂️ Team ████████████░░░░░░░░░░░░░░  46%    🤖 AI ████░░░  22%   │
├───────────────────────────────────────────────────────────────────────┤
│                                                                       │
│   [  횡스크롤 액션 화면: 캐릭터가 달리며 코드가 말풍선으로 노출  ]    │  📊
│      🏃 캐릭터                                                         │  레
│       💬 "user_list = []"                                             │  이
│                                                       🤖 AI Shadow   │  더
│                                                                       │  차
├───────────────────────────────────────────────────────────────────────┤  트
│  [코드 입력창]  user_list = []█                                       │
│  팀원 상태: [🟢 플레이어1 (현재 주자)] [⚪ 플레이어2] [⚪ 플레이어3] │
└───────────────────────────────────────────────────────────────────────┘
```

### 4.2 구역별 역할

| 위치 | 내용 |
|------|------|
| **상단** | 전체 트랙 진척도 바 (우리 팀 위치 vs AI 위치 실시간 표시) |
| **중앙** | 캐릭터가 달리는 횡스크롤 액션 화면. 입력한 코드가 말풍선으로 노출 |
| **하단** | 코드 입력창 + 팀원 상태창 (현재 주자 하이라이트 처리) |
| **우측** | 실시간 5대 지표 레이더 차트 |

### 4.3 5대 지표 레이더 차트

```
         설계
          ▲
    일관성 ◆ 추상화
  구현력 ◆   ◆ 예외처리
```

| 지표 | 측정 방식 |
|------|-----------|
| **일관성** | 팀원 간 변수명 재사용률 |
| **추상화** | 함수화·모듈화 횟수 |
| **예외 처리** | if-else / try-catch 사용 적절성 |
| **구현력** | 오타 없이 완성한 라인 비율 |
| **설계** | 전체 코드 구조의 논리 흐름 점수 |

---

## 5. 🏆 승리 및 평가 조건

### 5.1 1차 판정: 레이스 결과 (Race Result)

- AI보다 **먼저 목적지(논리의 성)에 도달했는가?**
- 실패 시 → **게임 오버** (AI에게 추월당한 지점 확인 가능)

### 5.2 2차 판정: 로직 점수 (Logic Score)

| 등급 | 조건 | 피드백 예시 |
|------|------|-------------|
| **S** | 5대 지표 평균 90점 이상 | "완벽한 팀워크! 모든 지표가 빛납니다!" |
| **A** | 평균 75~89점 | "속도는 빨랐으나 예외 처리가 부족해 A등급입니다!" |
| **B** | 평균 60~74점 | "일관성을 더 신경 쓰면 A등급까지 가능합니다!" |
| **C** | 평균 45~59점 | "함께 더 많이 연습해 봐요!" |
| **D** | 평균 45점 미만 | "다시 도전해보세요!" |

### 5.3 팀 보너스 점수

| 조건 | 보너스 |
|------|--------|
| 하이파이브 타이밍 전원 성공 | +10점 |
| 변수명 무결성 (위반 0회) | +15점 |
| AI와 격차 30% 이상 | +20점 |

---

## 6. 🔧 기술 구현 방안

### 6.1 기존 시스템 재활용 가능 요소

| 기존 모듈 | 재활용 방안 |
|-----------|-------------|
| `socket_server.py` | 실시간 멀티플레이어 동기화 (바통 패스 이벤트 전송) |
| `chaos_agent.py` | AI 추격자 로직으로 변환 (코드 생성 속도 = 추격 속도) |
| 5대 지표 레이더 차트 (기존 UI) | 실시간 점수 표시로 직접 재사용 |
| 의사코드 평가 엔진 | 라인별 실시간 평가로 변환 |

### 6.2 신규 구현 필요 요소

| 구성 요소 | 설명 | 우선순위 |
|-----------|------|----------|
| 릴레이 섹터 관리자 | 플레이어별 섹터 할당, 바통 패스 이벤트 처리 | 🔴 HIGH |
| 횡스크롤 게임 화면 | 캐릭터 이동, 아이템/방해 요소 렌더링 | 🔴 HIGH |
| AI 추격자 엔진 | 난이도별 AI 속도 제어, 추격 위치 계산 | 🔴 HIGH |
| 하이파이브 타이밍 판정 | 두 플레이어 동시 키 입력 감지 (허용 오차 ±250~300ms, 클라이언트 1차 판정) | 🟡 MEDIUM |
| 팀원 상태창 | 현재 주자 하이라이트, 팀원 진행 상황 표시 | 🟡 MEDIUM |
| 방해 요소 트리거 | 오타/중복코드 감지 시 이벤트 발동 | 🟡 MEDIUM |

---

## 7. 📅 구현 일정 (예상)

```
Week 1: 핵심 백엔드 구축
  ├─ 릴레이 섹터 관리자 구현
  ├─ AI 추격자 엔진 구현
  └─ 소켓 이벤트 정의 (baton_pass, ai_position, high_five)

Week 2: 프론트엔드 게임 화면 구현
  ├─ 횡스크롤 캐릭터 화면 (Vue.js + Canvas)
  ├─ 코드 입력창 + 실시간 검증 UI
  └─ 팀원 상태창 구현

Week 3: 아이템/방해 요소 + 평가 시스템
  ├─ 방해 요소 트리거 로직
  ├─ 아이템 획득 및 효과 구현
  └─ 최종 점수 집계 및 등급 부여

Week 4: 통합 테스트 + 밸런싱
  ├─ 멀티플레이어 통합 테스트
  ├─ AI 속도 밸런싱 조정
  └─ UI/UX 폴리싱
```

---

## 8. ✅ 확정된 상세 설계 (2026-02-24 팀 논의 반영)

### 8.1 AI 추격 속도 기준 (난이도 설계)

| 난이도 | 레벨 | AI 타이핑 속도 | 특징 |
|--------|------|----------------|------|
| 🟢 초급 | Lv 1~3 | **150 CPM** | 천천히 생각하며 쳐도 이길 수 있는 수준 |
| 🟡 중급 | Lv 4~7 | **300 CPM** | 오타 한 번이면 바로 잡힐 정도의 압박감 |
| 🔴 고급 | Lv 8~10 | **450 CPM** | 하이파이브 부스트 + 추상화 아이템 필수 활용 수준 |

**동적 조정 - 분노 모드 (Rage Mode):**
- 팀이 AI보다 **30% 이상 앞서면** AI가 분노 모드 진입
- 약 **10~15초간 속도 1.5배** 상승 이벤트 발동
- 경고 이펙트(붉은 화면 테두리 + 진동)로 플레이어에게 사전 경보

```
[일반 모드]  AI ─────────────────────────────►
[분노 모드]  AI ══════════════════════════════► (속도 1.5x, 15초)
```

---

### 8.2 섹터 길이 및 인원수 조정 방식

**기준: 인당 담당 라인 수 (한 섹터 = 10~15줄)**

| 팀 구성 | 섹터 수 | 전체 라인 수 | 비고 |
|---------|---------|-------------|------|
| 2인 팀 | 2개 | 20~30줄 | 각자 1번씩 주자 역할 |
| 3인 팀 | 3개 | 30~45줄 | 각자 1번씩 주자 역할 |
| 에이스 모드 | 유동적 | 동일 | 숙련자가 2개 섹터 담당 가능 |

**에이스 모드 (Ace Mode) 상세:**
- 3인 팀에서 특정 플레이어가 **초보자**인 경우 활성화 가능
- 숙련자 1명이 섹터 2개 담당, 나머지 2명이 섹터 1개씩 담당
- 에이스 모드로 완주 시 **에이스 보너스 -10점** (난이도 감소에 대한 패널티)

---

### 8.3 기존 데이터 연동 방식

**결정: 기존 데이터 활용 + `run_game_metadata` 필드 추가**

```json
// 기존 퀘스트 JSON에 추가되는 메타데이터 구조
{
  "quest_id": "quest_001",
  "title": "로그인 시스템 설계",
  "run_game_metadata": {
    "total_lines": 30,
    "obstacles": [
      { "type": "logic_swamp", "line_index": 8, "trigger": "if-else 구조 필요" },
      { "type": "spaghetti_zone", "line_index": 20, "trigger": "중복 코드 감지" }
    ],
    "consistency_checkpoints": [
      { "line_index": 5, "variable": "user_list" },
      { "line_index": 15, "variable": "auth_token" }
    ],
    "abstraction_reward_line": 22
  }
}
```

- 기존 퀘스트 데이터를 **그대로 게임 맵으로 변환**
- `line_index` 태깅만으로 방해 요소/체크포인트 위치 지정 가능
- 신규 퀘스트 제작 없이 **기존 퀘스트 전체 즉시 활용 가능**

---

### 8.4 하이파이브 타이밍 허용 오차 (네트워크 고려)

**판정 방식: 클라이언트 1차 판정 → 서버 검증**

```
[플레이어 A] 키 입력 ──► 클라이언트 1차 판정 (±250~300ms 허용)
                              │
                              ▼
                         서버 전송 & 검증
                              │
                         결과 브로드캐스트
[플레이어 B] 키 입력 ──►/
```

| 항목 | 설정값 | 이유 |
|------|--------|------|
| 허용 오차 | **±250~300ms** | 리듬 게임보다 너그럽게 설정, 억울함 방지 |
| 판정 주체 | 클라이언트 1차 → 서버 검증 | 레이턴시 영향 최소화 |
| UX 보정 | Tweening 애니메이션 적용 | 입력 시간이 달라도 시각적으로 동시에 손을 맞잡는 것처럼 표현 |

**시각적 보정 (Tweening):**
- 두 플레이어의 입력 시간이 ±250ms 내에 있으면
- 애니메이션상으로는 **동시에 하이파이브**하는 것처럼 보간 처리
- 네트워크 상태가 나빠도 UX 품질 유지

---

*기획안 확정 일자: 2026-02-24 | 추가 수정 시 날짜 업데이트 요망*
