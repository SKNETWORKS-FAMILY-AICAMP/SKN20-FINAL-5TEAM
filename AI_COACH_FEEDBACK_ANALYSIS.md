# AI Coach 피드백 분석

> 작성일: 2026-02-27
> 대상: AI Coach 기능 답변 품질 피드백

---

## 받은 피드백 원문

> "근거 기반으로 답변할 수 있게 했으면 좋겠다"
> "성장 리포트도 있으면 좋을 거 같다. 그래야 진짜 코치같다고 생각. 특정 부분이 개선되었다 등등 알려주면 좋을 듯하다. 있는 걸 잘 종합하는 거니까 데이터 근거, 수치 방향 구체성 등을 잘 고려해보면 좋을 것 같다"
> "근거 기반으로 신뢰성 확보하면 좋을 거 같다"

이 세 가지는 같은 문제의 다른 표현. 현재 AI Coach의 **구조적 한계**를 정확히 짚은 것.

---

## 현재 시스템 상태

데이터는 이미 수집하고 있음:

| 도구 | 수집하는 데이터 |
|------|----------------|
| `get_user_scores` | 유닛별 평균점수, 최고점수, 풀이수, 완료율 |
| `get_weak_points` | 메트릭별 평균점수, AI 피드백 샘플 |
| `get_recent_activity` | 최근 풀이 기록 (날짜, 점수, 시도 횟수) |

**문제는 데이터가 없는 게 아님.**
LLM에게 데이터가 전달되지만, 응답에서 수치를 명시적으로 인용하도록 강제하지 않아서 막연한 답변이 나옴.

```
❌ 현재 (막연한 답변)
"edgeCase 부분이 약하니 예외 상황을 더 연습해봐요."

✅ 기대하는 답변 (근거 기반)
"unit01의 edgeCase 평균 점수가 45.3점으로 기준(70점)보다
24.7점 낮습니다. 최근 3회 풀이에서도 모두 50점 미만이었어요."
```

---

## 갭(Gap) 분석

### Gap 1: 근거 인용 문제

**원인**: `RESPONSE_STRATEGIES` 프롬프트가 LLM에게 "수치를 반드시 인용하라"는 지시를 충분히 강제하지 않음.

- 도구 결과는 `called_tools_cache`에 저장되어 LLM에게 전달됨
- 하지만 LLM이 이 데이터를 요약·해석해버리고 구체적 숫자를 생략하는 경향이 있음

**관련 파일**: `backend/core/views/coach/coach_view.py`, `backend/core/views/coach/coach_prompt.py`

---

### Gap 2: 성장 리포트 미존재

현재 시스템은 **현재 상태 스냅샷**만 보여줌. 시간 흐름에 따른 변화 추적이 없음.

```
현재:  "edgeCase 45점으로 약점입니다"

코치:  "edgeCase가 첫 시도 30점 → 45점으로 +15점 향상됐고,
       지난 주 대비 풀이 속도도 빨라졌습니다.
       하지만 아직 목표(70점)까지 25점 남았습니다."
```

`UserSolvedProblem` 모델에 `attempt_number`와 `solved_date`가 있어서 **기술적으로 구현 가능**하지만 현재 활용하지 않음:

- `get_growth_trend` 같은 도구 없음
- 1차 시도 vs 최신 시도 점수 비교 없음
- 특정 약점이 개선됐는지 판단 로직 없음

**관련 파일**: `backend/core/views/coach/coach_tools.py`, `core/models.py`

---

### Gap 3: "진짜 코치" 부재

피드백 핵심 표현 "**그래야 진짜 코치같다**"

| 항목 | 현재 코치 | 진짜 코치 |
|------|-----------|---------|
| 근거 | 막연한 조언 | "unit01 edgeCase 45.3점 → 개선 필요" |
| 비교 | 현재 상태만 | "지난 주 대비 +12점, 최초 대비 +20점" |
| 방향 | "더 연습해봐" | "이 3개 문제를 이 순서로 풀면 목표 달성" |
| 예측 | 없음 | "현재 속도면 2주 안에 70점 달성 가능" |

---

## 개선 방향

### 1. 프롬프트 수정 (단기, 빠른 효과)

`RESPONSE_STRATEGIES` 안에 아래 지시 추가:

> "응답할 때 반드시 도구에서 받은 수치(점수, 횟수, 완료율 등)를 직접 언급하라.
> 예: '평균 45.3점', '3회 시도 중 2회 실패', '완료율 60%' 등.
> 수치 없이 막연한 조언만 하는 것은 금지."

**파일**: `backend/core/views/coach/coach_prompt.py`

---

### 2. 성장 추이 도구 추가 (중기)

새 도구 `get_growth_trend(unit_id)` 구현:

```python
# 계산해야 할 값들
{
  "unit_id": "unit01",
  "first_attempt_avg": 35.0,   # 첫 시도 평균
  "latest_avg": 62.4,          # 최근 시도 평균
  "improvement": +27.4,        # 향상폭
  "metric_trends": {
    "edgeCase": {"first": 30, "latest": 45, "delta": +15},
    "design":   {"first": 40, "latest": 70, "delta": +30},  # 개선 완료
  },
  "weekly_avg": [45, 52, 58, 62],  # 주별 추이
}
```

**파일**: `backend/core/views/coach/coach_tools.py`

---

### 3. 성장 리포트 포맷 정의 (중기)

프리셋 버튼 "성장 리포트"가 이미 있지만 내용이 현재 상태 스냅샷에 불과.
아래 구조를 갖춘 실제 리포트 필요:

```
## 성장 리포트 (2026-02-01 ~ 2026-02-27)

### 전체 요약
- 총 풀이: 24문제 (지난 달 대비 +8)
- 전체 평균: 62.4점 → 71.2점 (+8.8점 향상)

### 유닛별 변화
| 유닛 | 첫 시도 | 현재 | 변화 |
|------|--------|------|------|
| Unit01 (의사코드) | 45점 | 68점 | ▲+23점 |
| Unit02 (디버깅)   | 52점 | 75점 | ▲+23점 |

### 개선된 약점
- ✅ design (35점 → 72점): 목표 달성!
- 🔄 edgeCase (30점 → 45점): 진행 중 (목표까지 25점)

### 다음 목표
- edgeCase 70점 달성을 위한 추천 문제 3개
```

---

## 우선순위 정리

| 우선순위 | 작업 | 예상 효과 | 난이도 |
|---------|------|---------|--------|
| 1 | 프롬프트에 수치 인용 강제 지시 추가 | 즉시 답변 품질 개선 | 낮음 |
| 2 | `get_growth_trend` 도구 구현 | 성장 추이 데이터 제공 | 중간 |
| 3 | 성장 리포트 응답 포맷 정의 | "진짜 코치" 경험 구현 | 중간 |
| 4 | 개선 완료된 약점 감지 로직 | 긍정적 피드백 루프 | 높음 |

---

## 관련 파일

- `backend/core/views/coach/coach_view.py` - SSE 스트리밍, Intent 분류
- `backend/core/views/coach/coach_tools.py` - 6개 도구 구현
- `backend/core/views/coach/coach_prompt.py` - 시스템 프롬프트, 응답 전략
- `frontend/src/features/ai-coach/AICoach.vue` - 프론트엔드 채팅 UI
